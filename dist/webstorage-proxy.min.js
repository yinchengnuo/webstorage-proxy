!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).WebStorageProxy=t()}(this,function(){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?i(e):t}function o(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];console.log(t)}function f(e,t){try{switch(e){case"TypeError":throw new TypeError(t);case"ReferenceError":throw new ReferenceError(t);case"RangeError":throw new RangeError(t);default:throw new Error(t)}}catch(e){return console.error(e),e}}var e=function(){function t(e){r(this,t),this.option=e}return function(e,t,o){t&&n(e.prototype,t),o&&n(e,o)}(t,[{key:"proxy",value:function(){return function(){var n=this;return new Proxy(this,{set:function(){n.nameSpace?console.log(n.nameSpace):console.log("set")},get:function(){if(console.log("get"),n.nameSpace){var e=window[n.type].getItem("_NAMESPACE:".concat(n.nameSpace))?JSON.parse(window[n.type].getItem("_NAMESPACE:".concat(n.nameSpace))):{};console.log(e);for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return e[o[1]]}console.log("set")}})}.call(this)}}]),t}(),t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},u="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,s=(u||p||Function("return this")()).Symbol,y=Object.prototype,g=y.hasOwnProperty,S=y.toString,b=s?s.toStringTag:void 0;var h=function(e){var t=g.call(e,b),o=e[b];try{var r=!(e[b]=void 0)}catch(e){}var n=S.call(e);return r&&(t?e[b]=o:delete e[b]),n},w=Object.prototype.toString;var d=function(e){return w.call(e)},m=s?s.toStringTag:void 0;var v=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":m&&m in Object(e)?h(e):d(e)},E=Array.isArray;var O=function(e){return null!=e&&"object"==typeof e};var j=function(e){return"string"==typeof e||!E(e)&&O(e)&&"[object String]"==v(e)};var P=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var A=function(e){if(!P(e))return!1;var t=v(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};function _(e){if(A(e))try{e.call()}catch(e){console.log(e)}}var T,R=function(){function o(e){var t;return r(this,o),t=l(this,c(o).call(this,e)),_.call(window,e.boforedCreate),t.flag="_WEBSTORAGEPROXY",t.nameSpaceFlag="_WEBSTORAGEPROXY_NAMESPACE",t.type=e.type,function(e){if(e)if(j(e))this.nameSpace=e;else{if(!A(e))return f("TypeError","配置参数'nameSpace'必须是一个字符串或函数");for(var t=[],o=0;o<window[this.type].length;o++)window[this.type].key(o).match(/_WEBSTORAGEPROXY_NAMESPACE:/)&&t.push(window[this.type].key(o).replace(/_WEBSTORAGEPROXY_NAMESPACE:/,""));if(window[this.type],!j(e(t)))return f("TypeError","当'nameSpace'为函数时，返回值必须为字符串");this.nameSpace=e(t)}else this.nameSpace=null}.call(i(t),e.nameSpace),t.state=Object.create(i(t)),Promise.resolve().then(function(){_.call(void 0,e.created)}),function(){function o(e){return e.split(":")[0]===t.flag||e.split(":")[0]===t.nameSpaceFlag}function r(){return f("ReferenceError","你必须使用 WebStorageProxy 对象的api来操作 WebStorageProxy 产生的数据。")}var t=this,e=Symbol("clear"),n=Symbol("getItem"),c=Symbol("setItem"),a=Symbol("removeItem"),i=window[this.type];Storage.prototype[e]=Storage.prototype.clear,Storage.prototype[n]=Storage.prototype.getItem,Storage.prototype[c]=Storage.prototype.setItem,Storage.prototype[a]=Storage.prototype.removeItem,Storage.prototype.clear=function(){for(var e=0;e<i.length;e++)o(i.key(0))||this.removeItem(i.key(0))},Storage.prototype.getItem=function(e){if(!o(e))return i[n](e);r()},Storage.prototype.setItem=function(e,t){o(e)?r():i[c](e,t)},Storage.prototype.removeItem=function(e){o(e)?r():i[a](e)}}.call(i(t)),l(t,t.state.proxy())}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(o,e),o}();function x(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];console.log(t)}return T=function e(t){if(r(this,e),!P(t))return f("TypeError","参数不合法！WebStorageProxy的参数必须是一个对象。");switch(t.type){case"cookie":return new o(t);case"sessionStorage":return new R(t);case"indexDB":return new x(t);default:return f("TypeError","参数不合法！type应是'coookie'、'sessionSorage'、'localStorage'、'indexDB'中的一个。")}},console.log("包装static方法"),T});
